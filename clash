### 全局配置
mixed-port: 7897
allow-lan: true
mode: rule
log-level: warning
ipv6: false
find-process-mode: strict
unified-delay: true
tcp-concurrent: true
global-client-fingerprint: chrome

profile:
  store-selected: true
  store-fake-ip: true

### DNS配置
dns:
  enable: true
  listen: 0.0.0.0:53
  ipv6: false
  prefer-h3: true
  enhanced-mode: fake-ip
  use-hosts: true
  use-system-hosts: true
  nameserver:
    - https://223.5.5.5/dns-query
    - https://dns.pub/dns-query
    - https://dns.flymc.cc/dns-query
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - 'rule-set:fakeip-filter'
    - 'rule-set:trackerslist'
    - 'rule-set:private'
    - 'rule-set:cn'
  nameserver-policy:
    'rule-set:reject_non_ip,reject_domainset,reject_non_ip_drop,reject_non_ip_no_drop':
      - rcode://success

### 域名嗅探
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain:
    - "Mijia Cloud"
    - dlg.io.mi.com
    - "+.push.apple.com"

### 策略组
proxy-groups:
  - name: 时光太浅1994
    type: select
    include-all: true
    proxies:
      - 自动选择
      - 故障转移
      - DIRECT

  - name: 自动选择
    type: url-test
    include-all: true
    url: "https://cp.cloudflare.com/generate_204"
    interval: 180
    tolerance: 100

  - name: 故障转移
    type: fallback
    include-all: true
    url: "https://cp.cloudflare.com/generate_204"
    interval: 60

### 规则集配置（全 text，直接写完整字段）
rule-providers:
  fakeip-filter:
    type: http
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/DustinWin/ruleset_geodata@mihomo-ruleset/fakeip-filter.mrs
    path: ./rule_set/other_ruleset/fakeip-filter.mrs
    interval: 43200
    format: text
    proxy: 时光太浅1994
  cn:
    type: http
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/DustinWin/ruleset_geodata@mihomo-ruleset/cn.mrs
    path: ./rule_set/other_ruleset/cn.mrs
    interval: 43200
    format: text
    proxy: 时光太浅1994
  private:
    type: http
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/DustinWin/ruleset_geodata@mihomo-ruleset/private.mrs
    path: ./rule_set/other_ruleset/private.mrs
    interval: 43200
    format: text
    proxy: 时光太浅1994
  trackerslist:
    type: http
    behavior: domain
    url: https://testingcf.jsdelivr.net/gh/DustinWin/ruleset_geodata@mihomo-ruleset/trackerslist.mrs
    path: ./rule_set/other_ruleset/trackerslist.mrs
    interval: 43200
    format: text
    proxy: 时光太浅1994
  reject_non_ip_no_drop:
    type: http
    behavior: classical
    url: https://ruleset.skk.moe/Clash/non_ip/reject-no-drop.txt
    path: ./rule_set/sukkaw_ruleset/reject_non_ip_no_drop.txt
    interval: 43200
    format: text
    proxy: 时光太浅1994
  reject_non_ip_drop:
    type: http
    behavior: classical
    url: https://ruleset.skk.moe/Clash/non_ip/reject-drop.txt
    path: ./rule_set/sukkaw_ruleset/reject_non_ip_drop.txt
    interval: 43200
    format: text
    proxy: 时光太浅1994
  reject_non_ip:
    type: http
    behavior: classical
    url: https://ruleset.skk.moe/Clash/non_ip/reject.txt
    path: ./rule_set/sukkaw_ruleset/reject_non_ip.txt
    interval: 43200
    format: text
    proxy: 时光太浅1994
  reject_domainset:
    type: http
    behavior: domain
    url: https://ruleset.skk.moe/Clash/domainset/reject.txt
    path: ./rule_set/sukkaw_ruleset/reject_domainset.txt
    interval: 43200
    format: text
    proxy: 时光太浅1994
# 其他 rule-provider 按同样格式写，全部 text，interval 保持纯数字

### 分流规则
rules:
  - RULE-SET,reject_non_ip,REJECT
  - RULE-SET,reject_domainset,REJECT
  - RULE-SET,reject_non_ip_drop,REJECT-DROP
  - RULE-SET,reject_non_ip_no_drop,REJECT
  - RULE-SET,cdn_non_ip,时光太浅1994
  - RULE-SET,stream_non_ip,时光太浅1994
  - RULE-SET,telegram_non_ip,时光太浅1994
  - RULE-SET,apple_cdn,DIRECT
  - RULE-SET,download_domainset,时光太浅1994
  - RULE-SET,download_non_ip,时光太浅1994
  - RULE-SET,microsoft_cdn_non_ip,DIRECT
  - RULE-SET,apple_cn_non_ip,DIRECT
  - RULE-SET,apple_services,时光太浅1994
  - RULE-SET,microsoft_non_ip,时光太浅1994
  - RULE-SET,ai_non_ip,时光太浅1994
  - RULE-SET,global_non_ip,时光太浅1994
  - RULE-SET,domestic_non_ip,DIRECT
  - RULE-SET,cn,DIRECT
  - RULE-SET,direct_non_ip,DIRECT
  - RULE-SET,lan_non_ip,DIRECT
  - RULE-SET,reject_ip,REJECT
  - RULE-SET,telegram_ip,时光太浅1994,no-resolve
  - RULE-SET,stream_ip,时光太浅1994
  - RULE-SET,lan_ip,DIRECT,no-resolve
  - RULE-SET,domestic_ip,DIRECT
  - RULE-SET,china_ip,DIRECT
  - MATCH,时光太浅1994
